<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>P1491 集合位置  | Kite-chaser</title>
<meta name="description" content="This is my blog.">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://Kite-chaser.github.io/favicon.ico?v=1568423252015">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://Kite-chaser.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
  
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://Kite-chaser.github.io">Kite-chaser</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                首页
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                归档
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                标签
              </a>
            
          </li>
        
          <li>
            
              <a href="https://Kite-chaser.github.io/post/guan-yu/" class="menu">
                关于
              </a>
            
          </li>
        
          <li>
            
              <a href="https://Kite-chaser.github.io/post/you-lian/" class="menu">
                友链
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>P1491 集合位置 </h1>
            <p class="article-meta">
              2019-08-19
              
                <a href="https://Kite-chaser.github.io/tag/fgReGJsqm" class="badge secondary">
                  题解
                </a>
              
                <a href="https://Kite-chaser.github.io/tag/nQBg2kv-6" class="badge secondary">
                  图论
                </a>
              
                <a href="https://Kite-chaser.github.io/tag/BsZO4xN8u" class="badge secondary">
                  OI
                </a>
              
            </p>
            
              <img src="https://Kite-chaser.github.io/post-images/p1491-ji-he-wei-zhi.png" alt="P1491 集合位置 ">
            
            <div class="post-content">
              <h4 id="题目描述">题目描述</h4>
<p>每次有大的活动，大家都要在一起“聚一聚”，不管是去好乐迪，还是避风塘，或者汤姆熊，大家都要玩的痛快。</p>
<!--more-->
<p>还记得心语和花儿在跳舞机上的激情与释放，还记得草草的投篮技艺是如此的高超，还记得狗狗的枪法永远是'S'……还有不能忘了，胖子的歌声永远是让我们惊叫的！！</p>
<p>今天是野猫的生日，所以想到这些也正常，只是因为是上学日，没法一起去玩了。但回忆一下那时的甜蜜总是一种幸福嘛。。。</p>
<p>但是每次集合的时候都会出现问题！野猫是公认的“路盲”，野猫自己心里也很清楚，每次都提前出门，但还是经常迟到，这点让大家很是无奈。后来，野猫在每次出门前，都会向花儿咨询一下路径，根据已知的路径中，总算能按时到了。</p>
<p>现在提出这样的一个问题：给出n个点的坐标，其中第一个为野猫的出发位置，最后一个为大家的集合位置，并给出哪些位置点是相连的。野猫从出发点到达集合点，总会挑一条最近的路走，如果野猫没找到最近的路，他就会走第二近的路。请帮野猫求一下这条第二最短路径长度。</p>
<blockquote>
<p><a href="https://www.luogu.org/problem/P1491">原题链接</a></p>
</blockquote>
<h2 id="solve">Solve</h2>
<p>1.次短路+SPFA。</p>
<p>2.SPFA找最短路，并记录路径。</p>
<p>3.删去最短路径中的一条边，并用SPFA寻找最短路。</p>
<p>4.重复3的步骤，其中最小值即为答案。</p>
<h2 id="tip">Tip</h2>
<p>1.此题并不是严格次短路，即答案可能与最短路的值相同。</p>
<p>2.步骤3中SPFA完成之后别忘了还原回去。</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">
#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;queue&gt;
#include&lt;cmath&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#define maxn 336860180  //定义一个最大范围
#define N 100000 
using namespace std;  //标准开头
int n,m,len;  //n,m-同题，len-邻接表边数
double x[N],y[N],dis[N],ans1,ans2=maxn;  //x,y-点的坐标，dis-最短路，ans1-最短路，ans2-步骤3中的最小值
int e,r;  //边的两点
int first[N],next[N],f[N][3];  //first,next-邻接表，f[i][1]-节点i的前驱边，f[i][2]-节点i的前驱点
bool vis[N];  //SPFA中的bool数组
struct note{  //邻接表
   int v;
   double w;
   bool fb;  //若fb为true,则此边已删
}d[N];
double dist(double x1,double y1,double x2,double y2){  //两点求距离
   return sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));
}
void add(int e,int r,double distt){  //建立邻接表
   d[++len].v=r;
   d[len].w=distt;
   next[len]=first[e];
   first[e]=len;
}
void spfa()  //步骤2的SPFA
{
   for(int i=1;i&lt;=n;i++) dis[i]=maxn;
   memset(vis,false,sizeof(vis));
   dis[1]=0;
   queue&lt;int&gt; q;
   q.push(1);
   while(!q.empty()){
   	int e=q.front();
   	q.pop();
   	vis[e]=false;
   	for(int i=first[e];i!=-1;i=next[i]){
   		if(dis[d[i].v]&gt;dis[e]+d[i].w){
   			f[d[i].v][1]=e;
   			f[d[i].v][2]=i;
   			dis[d[i].v]=dis[e]+d[i].w;
   			if(!vis[d[i].v]){
   				vis[d[i].v]=true;
   				q.push(d[i].v);
   			}
   		}
   	}
   }
}
void spfaa()  //步骤3中的SFPA
{
   for(int i=1;i&lt;=n;i++) dis[i]=maxn;
   memset(vis,false,sizeof(vis));
   dis[1] = 0;
   queue&lt;int&gt; q;
   q.push(1);
   while(!q.empty()){
   	int e=q.front();
   	q.pop();
   	vis[e]=false;
   	for(int i=first[e];i!=-1;i=next[i]){
   		if(dis[d[i].v]&gt;dis[e]+d[i].w&amp;&amp;!d[i].fb){
   			dis[d[i].v]=dis[e]+d[i].w;
   			if(!vis[d[i].v]){
   				vis[d[i].v]=true;
   				q.push(d[i].v);
   			}
   		}
   	}
   }
}
int main()
{
   scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
   for(int i=1;i&lt;=n;i++) cin&gt;&gt;x[i]&gt;&gt;y[i],first[i]=-1;
   for(int i=1;i&lt;=m;i++){
   	scanf(&quot;%d%d&quot;,&amp;e,&amp;r);
   	add(e,r,dist(x[e],y[e],x[r],y[r]));
   	add(r,e,dist(x[e],y[e],x[r],y[r]));
   }
   spfa();
   int s=n;
   ans1=dis[n];
   if(ans1==maxn){
   	cout&lt;&lt;&quot;-1&quot;;
   	return 0;
   }
   while(s!=1){
   	d[f[s][2]].fb=true;
   	spfaa();
   	if(ans1==dis[n]){
   		printf(&quot;%.2lf&quot;,ans1);
   		return 0;
   	}
   	d[f[s][2]].fb=false;  //还原
   	s=f[s][1];
   	ans2=min(ans2,dis[n]);
   }
   if(ans2==maxn) cout&lt;&lt;&quot;-1&quot;;
   else printf(&quot;%.2lf&quot;,ans2);
   return 0;
}
</code></pre>

            </div>
          </article>
        </div>
        <div class="paper" data-aos="fade-in">
          
            <div class="next-post">
              <div class="next">
                下一篇
              </div>
              <a href="https://Kite-chaser.github.io/post/p2829-da-tao-chi">
                <h3 class="post-title">
                  P2829 大逃离
                </h3>
              </a>
            </div>
          
        </div>
        
          
            <div class="paper" data-aos="fade-in">
              <div id="gitalk-container"></div>
            </div>
          

          
        
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img src="https://Kite-chaser.github.io/images/avatar.png?v=1568423252015" class="no-responsive avatar">
    <div class="text-muted">This is my blog.</div>
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      最新文章
    </div>
    <div class="row">
      <ul>
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/zheng-chu">整除</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/uva11324-the-largest-clique">UVA11324 The Largest Clique</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/qiang-lian-tong-fen-liang">强连通分量</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/zui-da-du-li-ji">最大独立集</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/dong-tai-gui-hua-zhong-de-bei-bao-wen-ti">动态规划中的背包问题</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/shu-lun">数论</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/p1491-ji-he-wei-zhi">P1491 集合位置 </a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/p2829-da-tao-chi">P2829 大逃离</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/p2866-usaco06novzao-gao-de-yi-tian-bad-hair-day">P2866 [USACO06NOV]糟糕的一天Bad Hair Day</a>
            </li>
          
        
          
            <li>
              <a href="https://Kite-chaser.github.io/post/p1395-hui-yi">P1395 【会议】</a>
            </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      标签列表
    </div>
    <div class="row">
      
        <a href="https://Kite-chaser.github.io/tag/kCU-ep_Aq" class="badge secondary">
          笔记
        </a>
      
        <a href="https://Kite-chaser.github.io/tag/BsZO4xN8u" class="badge secondary">
          OI
        </a>
      
        <a href="https://Kite-chaser.github.io/tag/BCIKttOve" class="badge success">
          动态规划，DP
        </a>
      
        <a href="https://Kite-chaser.github.io/tag/fgReGJsqm" class="badge secondary">
          题解
        </a>
      
        <a href="https://Kite-chaser.github.io/tag/nQBg2kv-6" class="badge warning">
          图论
        </a>
      
        <a href="https://Kite-chaser.github.io/tag/92gh9uu1i" class="badge success">
          单调队列
        </a>
      
        <a href="https://Kite-chaser.github.io/tag/2kgafuTx9" class="badge secondary">
          线段树
        </a>
      
        <a href="https://Kite-chaser.github.io/tag/ksq4_sfEo" class="badge secondary">
          并查集
        </a>
      
    </div>
  </div>
  <div class="paper">
    Powered by Hve Notes | <a class="rss" href="https://Kite-chaser.github.io/atom.xml" target="_blank">RSS</a>
  </div>
</div>


    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '761ba32522ad16d2134b',
        clientSecret: 'd5634ea03ca976d589a06f88c4e9fb23c928e5f9',
        repo: 'Kite-chaser.github.io',
        owner: 'Kite-chaser',
        admin: ['Kite-chaser'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
