<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>P3088 [USACO13NOV]挤奶牛Crowded Cows | Kite-chaser</title>
<meta name="description" content="This is my blog.">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="shortcut icon" href="https://Kite-chaser.github.io/favicon.ico">
<link rel="stylesheet" href="https://Kite-chaser.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://Kite-chaser.github.io">
        <img src="https://Kite-chaser.github.io/images/avatar.png" class="site-logo">
        <h1 class="site-title">Kite-chaser</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="https://Kite-chaser.github.io/post/guan-yu/" class="site-nav">
            关于
          </a>
        
      
        
          <a href="https://Kite-chaser.github.io/post/you-lian/" class="site-nav">
            友链
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="site-description">
      This is my blog.
    </div>
    <div class="site-footer">
      Powered by Hve Notes
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">P3088 [USACO13NOV]挤奶牛Crowded Cows</h2>
            <div class="post-date">2019-08-18</div>
            
              <div class="feature-container" style="background-image: url('https://Kite-chaser.github.io/post-images/p3088-usaco13novji-nai-niu-crowded-cows.jpg')">
              </div>
            
            <div class="post-content">
              <h4 id="题目描述">题目描述</h4>
<p>Farmer John's N cows (1 &lt;= N &lt;= 50,000) are grazing along a one-dimensional fence. Cow i is standing at location x(i) and has height h(i) (1 &lt;= x(i),h(i) &lt;= 1,000,000,000).</p>
<!--more-->
<p>A cow feels &quot;crowded&quot; if there is another cow at least twice her height within distance D on her left, and also another cow at least twice her height within distance D on her right (1 &lt;= D &lt;= 1,000,000,000). Since crowded cows produce less milk, Farmer John would like to count the number of such cows. Please help him.</p>
<p>FJ有N(1 &lt;= N &lt;= 50,000)头奶牛沿着一维的栅栏吃草，第i头奶牛在目标点x(i) ，它的身高是 h(i) (1 &lt;=x(i),h(i) &lt;= 1,000,000,000)。</p>
<p>当一头奶牛左边D距离内而且右边D距离内有身高至少是它的两倍的奶牛，t (1 &lt;= D &lt;= 1,000,000,000)，它就会觉得拥挤。</p>
<p>请计算觉得拥挤的奶牛的数量。</p>
<blockquote>
<p><a href="https://www.luogu.org/problem/P3088">原题链接</a></p>
</blockquote>
<h3 id="solve">Solve</h3>
<p>手动模拟一下队列就行。</p>
<p>1.一个递减的单调队列，保证队首是最近最高的“奶牛”（最高优先）</p>
<p>2.依次遍历，如果队首的比他高两倍以上，就把他标记下来；否则就不标。</p>
<p>3.从左到右，从右到左，重复两次，有两次标记的就是“Crowded Cows&quot;。</p>
<h4 id="tips">Tips：</h4>
<p>为什么如此标记呢？</p>
<p>首先，我们保证了队首是最近最高的“奶牛”。所以如果队首都没有他高，那就没有比他高的的了（最起码他前面没有了）。而第二次遍历就是解决他后面是否有比他高的“奶牛”（上文的“高”都是指高出两倍及以上）。</p>
<p>具体见代码</p>
<h3 id="code">Code</h3>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
using namespace std;  //标准开头
const int N=500001;
int n,m;  //n==n,m==d
int q[N][3];  //核心队列
struct note{
	int x,h,r;
}d[N];  //d存储每头“奶牛”的信息——位置（x），高度（h)，序号(r)（序号可以方便标记）
bool vis[N][3];  //标记小能手
int ans;   //答案
int head=1,tail=1;  //head——队首，tail——队尾
bool cmp(const note &amp;a,const note &amp;b){  //按位置从小到大排
	return a.x&lt;b.x;
}
int main()
{
	memset(q,0,sizeof(q));
	memset(vis,false,sizeof(vis));
	cin&gt;&gt;n&gt;&gt;m;
	for(int i=1;i&lt;=n;i++) cin&gt;&gt;d[i].x&gt;&gt;d[i].h,d[i].r=i;
	sort(d+1,d+1+n,cmp);  //sort快排，其实也可以换成其他的方法，只要不影响结果
	q[head][0]=d[1].r;
	q[head][1]=d[1].x;
	q[head][2]=d[1].h;
	for(int i=2;i&lt;=n;i++){
		while(q[head][1]&lt;d[i].x-m&amp;&amp;head&lt;=tail) head++;  //如果队首的位置已经超出了当前“奶牛”的范围，那么队首就没有“利用价值”了，甚至会影响正常标记，所以必须删去（其实删去不是真正的删去，只是头指针后移）。
		if(q[head][2]&gt;=d[i].h*2) vis[d[i].r][1]=true;  //标记
		while(q[tail][2]&lt;d[i].h&amp;&amp;tail&gt;=head) tail--;  //队列更新
		tail++;
		q[tail][0]=d[i].r;
		q[tail][1]=d[i].x;
		q[tail][2]=d[i].h;
	}
	head=1;
	tail=1;
	memset(q,0,sizeof(q));
	q[head][0]=d[n].r;
	q[head][1]=d[n].x;
	q[head][2]=d[n].h;
	for(int i=n-1;i&gt;=1;i--){  //再来一遍
		while(q[head][1]&gt;d[i].x+m&amp;&amp;head&lt;=tail) head++;
		if(q[head][2]&gt;=d[i].h*2) vis[d[i].r][2]=true;
		while(q[tail][2]&lt;d[i].h&amp;&amp;tail&gt;=head) tail--;
		tail++;
		q[tail][0]=d[i].r;
		q[tail][1]=d[i].x;
		q[tail][2]=d[i].h;
	}
	for(int i=1;i&lt;=n;i++){  //注意是两次标记都有，才是“Crowded Cows”
		if(vis[i][1]==true&amp;&amp;vis[i][2]==true) ans++;
	}
	cout&lt;&lt;ans;  //完美输出
	return 0;
}
</code></pre>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://Kite-chaser.github.io/tag/92gh9uu1i" class="tag">
                    单调队列
                  </a>
                
                  <a href="https://Kite-chaser.github.io/tag/BsZO4xN8u" class="tag">
                    OI
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://Kite-chaser.github.io/post/p4879-ycz-de-mei-zi">
                  <h3 class="post-title">
                    P4879 ycz的妹子
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  
  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '761ba32522ad16d2134b',
        clientSecret: 'd5634ea03ca976d589a06f88c4e9fb23c928e5f9',
        repo: 'Kite-chaser.github.io',
        owner: 'Kite-chaser',
        admin: ['Kite-chaser'],
        id: location.pathname,      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
